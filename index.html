<!DOCTYPE html>
<head>
  <meta charset="utf-8" />
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css"
  />
  <link rel="stylesheet" href="./style.css" />
</head>
<body>
  <div class="main">
    <h1 class="title">
      <image
        class="logo"
        alt="Mintel logo"
        src="./assets/Mintel_Store_Logo_2022.png"
      ></image>
      GrabACoffee
    </h1>
    <div id="form">
      <p class="description">
        Enter your name below to find someone else looking to grab a coffee at
        Mintel London within the next 10 minutes!
      </p>
      <form class="form">
        <div class="field">
          <div class="control">
            <input class="input" type="text" name="name" placeholder="Name" />
          </div>
        </div>
        <div class="field">
          <div class="control is-expanded">
            <div class="select is-fullwidth">
              <select>
                <option>Mintel House - Ground Floor</option>
              </select>
            </div>
          </div>
        </div>

        <div class="control">
          <button class="button is-black" type="submit">
            Grab a coffee now!
          </button>
        </div>
      </form>
    </div>
    <div id="clock">
      <p class="description">TODO</p>
      <progress class="progress is-warning" value="0" max="100">75%</progress>
      <div id="timer"></div>
    </div>
  </div>

  <script>
    const formatTime = (seconds) => {
      return `${Math.floor(seconds / 60)}:${seconds % 60}`;
    };

    const TIMER_DURATION = 60; // seconds
    const name = new URLSearchParams(window.location.search).get("name");
    const formElement = document.getElementById("form");
    const clockElement = document.getElementById("clock");
    var seconds = TIMER_DURATION;

    if (name) {
      formElement.style.display = "none";
      clockElement.style.display = "block";
    } else {
      formElement.style.display = "block";
      clockElement.style.display = "none";
    }

    setInterval(() => {
      if (seconds > 0) {
        seconds -= 1;
      }

      document.getElementById("timer").innerHTML = formatTime(seconds);

      const progress = (1 - seconds / TIMER_DURATION) * 100;
      const progressBarElement = document.getElementsByTagName("progress")[0];
      progressBarElement.setAttribute("value", progress);
      progressBarElement.innerHTML = progress + "%";
    }, 1000);
  </script>
</body>
